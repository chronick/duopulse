---
iteration_id: 2026-01-20-007
goal: "Investigate high voice separation in wild zone"
type: investigation
status: completed
started_at: 2026-01-20T19:00:00Z
completed_at: 2026-01-20T19:45:00Z
branch: feature/iterate-2026-01-20-007
commit: pending
pr: pending
---

# Iteration 2026-01-20-007: Root Cause Investigation - High Voice Separation in Wild Zone

## Executive Summary

This iteration investigated why the wild zone produces voice separation values of 0.92 when the target range is 0.32-0.68. The investigation revealed **two compounding issues**:

1. **Statistical Artifact**: Averaging across ENERGY zones inflates the metric because sparse MINIMAL-zone patterns (ENERGY=0.10) have no overlap → voiceSeparation=1.0

2. **Design Misalignment**: The COMPLEMENT relationship in the spec means shimmer fills GAPS in anchor by design, creating HIGH voice separation at ALL SHAPE levels. The target range (0.32-0.68 for wild) assumes voices should overlap more for "power", but this contradicts the gap-filling design.

**Key Finding**: The eval targets assume wild zone should have 32-68% voice overlap, but the COMPLEMENT design spec says shimmer fills anchor's gaps, preventing overlap. The high separation is correct behavior per spec.

## Goal

Investigate why voiceSeparation = 0.92 in wild zone when target is 0.32-0.68.

## Baseline Metrics

From `metrics/baseline.json` (v1.0.15):
- Wild zone voiceSeparation: **0.92** (target: 0.32-0.68)
- Gap from target max: **+0.24** (35% over target maximum)
- Syncopated zone voiceSeparation: **0.92** (target: 0.52-0.78, gap: +0.14)
- Stable zone voiceSeparation: **0.88** (target: 0.62-0.88) - barely in range!

## Investigation Process

### Step 1: Understand Voice Separation Metric

From `evaluate-expressiveness.js:197-208`:

```javascript
function computeVoiceSeparation(v1Hits, v2Hits, auxHits, length = 32) {
  let overlap = 0;
  let totalActive = 0;

  for (let i = 0; i < length; i++) {
    const voicesActive = (v1Hits[i] ? 1 : 0) + (v2Hits[i] ? 1 : 0) + (auxHits[i] ? 1 : 0);
    if (voicesActive > 0) totalActive++;
    if (voicesActive >= 2) overlap++;
  }

  return totalActive > 0 ? 1.0 - (overlap / totalActive) : 0.5;
}
```

**Key Insight**:
- voiceSeparation = 1.0 - (overlap / totalActive)
- High separation (0.92) means only 8% of active steps have 2+ voices
- Low separation (0.32) would mean 68% of active steps have 2+ voices

### Step 2: Analyze Voice Separation by ENERGY Level

Examined voice separation at SHAPE=0.85 (wild zone) across ENERGY levels:

| ENERGY | Zone | voiceSeparation | Active Steps | Overlaps |
|--------|------|-----------------|--------------|----------|
| 0.10 | MINIMAL | **1.00** | 4 | 0 |
| 0.35 | GROOVE | 0.83 | 12 | 2 |
| 0.60 | BUILD | 0.82 | 17 | 3 |
| 0.85 | PEAK | 0.87 | 23 | 3 |

**Finding #1: Statistical Artifact**

At ENERGY=0.10 (MINIMAL zone), patterns are so sparse (only 4 hits total across voices) that overlap is statistically impossible. This inflates the wild zone average.

Example at ENERGY=0.10 + SHAPE=0.85:
```
V1 hits: 2 (at steps 20, 29)
V2 hits: 2 (at steps 10, 27)
Aux hits: 0
Total: 4 hits, all on different positions
Overlap: 0 → voiceSeparation = 1.0
```

### Step 3: Test DRIFT Parameter Hypothesis

Bootstrap heuristics suggested DRIFT as the primary lever for voice separation. Tested at ENERGY=0.6, SHAPE=0.85:

| DRIFT | voiceSeparation | Overlaps | Active Steps |
|-------|-----------------|----------|--------------|
| 0.0 | 0.85 | 3 | 20 |
| 0.25 | 0.85 | 3 | 20 |
| 0.50 | 0.85 | 3 | 20 |
| 0.75 | 0.89 | 2 | 19 |
| 1.0 | 0.89 | 2 | 19 |

**Finding #2: DRIFT Has Minimal Effect**

DRIFT only changes voiceSeparation by ~4% (0.85 → 0.89). This cannot bridge the gap to the target range (0.32-0.68).

### Step 4: Review Spec Design Intent

From `docs/specs/main.md:434-466`:

> "Voice 2 (shimmer) fills gaps in Voice 1 (anchor) pattern. DRIFT controls placement variation."

The COMPLEMENT relationship is designed to:
1. Find gaps in anchor pattern
2. Place shimmer hits WITHIN those gaps
3. DRIFT controls where within the gap (evenly spaced, weighted, or seed-varied)

**Key Insight**: The spec DESIGNS for high voice separation because shimmer fills GAPS, not overlaps.

DRIFT placement strategies:
- 0-30%: Evenly spaced within gaps
- 30-70%: Weight-based selection (best metric positions within gaps)
- 70-100%: Seed-varied placement within gaps

All strategies place shimmer IN GAPS, preventing overlap by design.

### Step 5: Analyze Target Range Assumption

The target range description says:
> "Separation affects clarity vs. power. High DRIFT should increase separation."

The assumption was:
- Wild zone should have MORE overlap for "power"
- Target: 0.32-0.68 (32-68% overlap)

But this contradicts the COMPLEMENT spec:
- Shimmer fills gaps → minimal overlap
- DRIFT varies placement within gaps, not overlap amount

**Finding #3: Target Range Misalignment**

The wild zone target (0.32-0.68) assumes voices should overlap significantly for "power", but the gap-filling COMPLEMENT design prevents overlap regardless of SHAPE or DRIFT.

## Root Cause Summary

| Issue | Description |
|-------|-------------|
| **Statistical Artifact** | MINIMAL zone sparse patterns (4 hits) can't overlap → voiceSep=1.0 inflates average |
| **Design Misalignment** | COMPLEMENT gap-filling creates HIGH separation by design at ALL zones |
| **Target Assumption Error** | Wild zone target assumes overlap for "power" but spec designs for gap-filling |

## Comparison with Syncopation Investigation (2026-01-20-006)

| Aspect | Syncopation (006) | Voice Separation (007) |
|--------|-------------------|------------------------|
| Current value | 0.95 | 0.92 |
| Target range | 0.22-0.48 | 0.32-0.68 |
| Gap | +0.47 | +0.24 |
| Root cause | Algorithm MAXIMIZES syncopation | Algorithm MINIMIZES overlap |
| Spec alignment | Working as designed | Working as designed |
| Target alignment | Targets expect moderate | Targets expect overlap |
| Resolution | Revise targets OR modify algorithm | Revise targets |

Both issues stem from **eval targets not matching spec design intent**.

## Possible Solutions

### Option A: Revise Target Ranges (Recommended)

Update `evaluate-expressiveness.js` to match COMPLEMENT design:

```javascript
voiceSeparation: {
  targetByZone: {
    stable: '0.75-0.95',      // High separation (gap-filling)
    syncopated: '0.70-0.92',  // High separation (gap-filling)
    wild: '0.65-0.95'         // High separation (may be slightly lower due to chaos)
  },
}
```

**Pros**: Matches spec design intent, quick fix
**Cons**: Changes evaluation baseline significantly

### Option B: Make Voice Separation ENERGY-Dependent

Current targets are SHAPE-based but voiceSeparation depends heavily on ENERGY:
- Low ENERGY → sparse patterns → very high separation
- High ENERGY → denser patterns → lower separation

Could adjust scoring to account for ENERGY, not just SHAPE.

**Pros**: More nuanced evaluation
**Cons**: More complex implementation

### Option C: Accept as Design Tradeoff

Document that the COMPLEMENT relationship creates high separation by design, and this is a feature (clarity) not a bug.

**Pros**: No code changes
**Cons**: Pentagon score remains low

## Recommendation

**Short-term**: Implement Option A - revise voiceSeparation targets to match the COMPLEMENT design spec:
- stable: 0.75-0.95
- syncopated: 0.70-0.92
- wild: 0.65-0.95

**Rationale**: The current targets assume voices should overlap for "power" but the spec explicitly designs for gap-filling (high separation). The algorithm is working correctly; the targets are wrong.

## Decision

This iteration is an **INVESTIGATION**, not a lever-change iteration. No algorithm changes were made.

**Next Steps**:
1. Create a task to revise voiceSeparation target ranges in evaluate-expressiveness.js
2. Consider combining with syncopation target revision from iteration 006
3. Update iteration-lessons.json with these findings

## Lessons Learned

### Key Insight

The voice separation metric and the COMPLEMENT algorithm work together correctly:
- COMPLEMENT finds gaps in anchor
- COMPLEMENT places shimmer in gaps
- Result: minimal overlap → high voiceSeparation

The eval targets assumed "power" in wild zone requires overlap, but the spec's gap-filling design prevents this.

### Pattern Recognition

This is the SECOND metric where eval targets don't match spec design:
1. **Syncopation** (006): Algorithm maximizes displacement, targets expect moderate
2. **Voice Separation** (007): Algorithm minimizes overlap, targets expect moderate

Common pattern: Eval targets may have been set aspirationally rather than based on algorithm capabilities.

### Investigation Value

This investigation prevented wasted effort on parameter tuning. The design-critic correctly identified this as a potential design alignment issue similar to syncopation.

Key validations:
- Sensitivity matrix showing no strong levers → correct (no lever can change COMPLEMENT design)
- DRIFT minimal effect → confirmed (DRIFT varies placement within gaps, not overlap)
- Bootstrap heuristic inaccurate → confirmed (DRIFT is not the primary control)

## Files Examined

| File | Lines | Finding |
|------|-------|---------|
| `tools/evals/evaluate-expressiveness.js` | 197-208 | voiceSeparation = 1.0 - (overlap/active) |
| `tools/evals/evaluate-expressiveness.js` | 58-62 | Target ranges by zone |
| `tools/evals/public/data/energy-zone-metrics.json` | - | ENERGY=0.10 → voiceSep=1.0 |
| `docs/specs/main.md` | 434-466 | COMPLEMENT gap-filling design |
| `metrics/sensitivity-matrix.json` | - | No strong levers for voiceSeparation |

## Narration

This iteration started when auto-detection identified wild zone voice separation (0.92) as a significant gap from target (0.32-0.68). Before attempting lever changes, the design-critic recommended investigation because sensitivity data showed no strong levers.

The investigation revealed two compounding issues:

First, the baseline metric is inflated by sparse MINIMAL-zone patterns. At ENERGY=0.10, patterns have so few hits (4 total across voices) that overlap is impossible, giving voiceSeparation=1.0. This pulls up the average.

Second, and more fundamentally, the COMPLEMENT relationship in the spec is DESIGNED to prevent overlap. Shimmer fills GAPS in anchor, not positions where anchor plays. This creates high voice separation at ALL zones, not just stable.

The DRIFT parameter, which the bootstrap heuristic identified as the primary lever, only controls WHERE within a gap shimmer is placed - not whether it overlaps with anchor. Testing confirmed DRIFT changes voiceSeparation by only 4%.

The wild zone target (0.32-0.68) assumes 32-68% voice overlap for "power", but the gap-filling design prevents this. The high separation (0.92) is actually CORRECT behavior per spec.

This parallels the syncopation finding from iteration 006: both metrics have targets that don't match algorithm design intent. The recommendation is to revise the voiceSeparation targets to match the COMPLEMENT design, accepting that the gap-filling relationship creates high separation by design.

This investigation saved effort on futile lever changes and identified a systematic issue: eval targets may need comprehensive review against spec design intent.
