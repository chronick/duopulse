## Improvement Estimates

**Goal**: Improve fill accent placement (0% score → 55%+ target)
**Target Metric**: fillAccentPlacement

### Root Cause Analysis

**Problem**: Only 21% of fill accents land on downbeats. Target is 55-80% for syncopated zone.

**Investigation Findings**:

1. **Base pattern places hits on offbeats**: Due to syncopation/rotation in GeneratePattern(), anchor/shimmer hits often land on offbeats (steps 3, 5, 9, 13, etc.) rather than downbeats (0, 4, 8, 12, etc.).

2. **Shimmer force accents boost ALL shimmer hits**: In PatternGenerator.cpp:313-317, when fillProgress > 0.85, the code boosts ALL shimmer hits to accent velocity:
   ```cpp
   // Force shimmer accents on all hits when fillProgress > 0.85
   if ((result.shimmerMask & (1ULL << step)) != 0)
   {
       result.shimmerVelocity[step] = std::max(...);
   }
   ```
   Since shimmer follows COMPLEMENT design (fills gaps in anchor), shimmer hits are mostly on offbeats.

3. **Aux gets no force accents**: Aux hits are boosted by velocity boost but not force accented.

4. **Result**: At fillProgress=1.0, ~5 accents on downbeats vs ~22 on offbeats = 18% ratio.

### Predicted Changes

**Code Changes**:
- `src/Engine/PatternGenerator.cpp`: Modify shimmer force accent logic to only boost downbeats

**Before** (line 313-317):
```cpp
// Force shimmer accents on all hits when fillProgress > 0.85
if ((result.shimmerMask & (1ULL << step)) != 0)
{
    result.shimmerVelocity[step] = std::max(result.shimmerVelocity[step], forceAccentVelocity * 0.9f);
}
```

**After**:
```cpp
// Force shimmer accents on DOWNBEATS only when fillProgress > 0.85
if ((result.shimmerMask & (1ULL << step)) != 0 && (step % 4 == 0))
{
    result.shimmerVelocity[step] = std::max(result.shimmerVelocity[step], forceAccentVelocity * 0.9f);
}
```

### Predicted Impact

**Primary Effect** (fillAccentPlacement):
- Predicted: +150-200% improvement (0.21 → 0.50-0.65)
- Reasoning: Removing ~15 offbeat shimmer force accents dramatically increases downbeat ratio
- Confidence: HIGH (85%)

**Secondary Effects**:
- fillVelocityBuild: Expected -5% to +5% (shimmer velocity still builds, just not to accent level on offbeats)
- fillDensityRamp: No change (density unaffected)
- Overall fill composite: Expected +60-80% (accent placement is 1/3 of composite)

**Risk Assessment**:
- Regression risk: LOW
- Potential issue: Fills may sound "thinner" with fewer accents
- Mitigation: Shimmer still gets velocity boost, just not force accent on offbeats

### Success Criteria

- fillAccentPlacement score >= 40% (from 0%)
- fillAccentPlacement raw metric >= 0.50 (from 0.21)
- Fill composite >= 40% (from 29%)
- No regression in density ramp or velocity build scores
- All tests pass

### Learning Objectives

What will this iteration teach us about:
- How accent distribution affects fill musical feel
- Whether downbeat-focused accents sound better musically
- If COMPLEMENT design requires special handling for fills
